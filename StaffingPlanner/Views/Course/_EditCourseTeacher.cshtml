@using StaffingPlanner.ViewModels;
@model CourseTeacherViewModel

    
<style>
    .glyphs {
        cursor: pointer;
        margin-left: 10px;
    }

    #cross {
        font-size: 23px;
        color: rgb(203, 40, 40);
    }

    #minus {
        font-size: 23px;
        color: rgb(149, 148, 148);
    }
</style>
<td>@Html.ActionLink(Model.Name, "TeacherDetails", "Teacher", new { id = Model.Id }, null)</td>
    <td>@Model.Title</td>
    <td>@Model.RemainingHours</td>
    <td>@Model.WorkloadFall</td>
    <td>@Model.WorkloadSpring</td>
<td>
    <input 
        type="number" 
        style="width: 60px; border:none" 
        id="@Model.WorkloadId" 
        name="@Model.WorkloadId"
        value="@Model.CourseWorkload"/> 

        <span
            class="pull-right glyphs"
            data-toggle="tooltip"
            title="Delete Teacher"
            data-offeringid="@Model.CourseId"
            data-workloadid="@Model.WorkloadId"
            onclick="DeleteTeacher(this)">
            <i class="glyphicon glyphicon-minus" id="cross"></i>
        </span>

        <span
            class="pull-right glyphs"
            data-toggle="tooltip"
            title="Cancel Changes"
            data-workloadid="@Model.WorkloadId"
            data-workload="@Model.CourseWorkload"
            onclick="CancelChanges(this)">
            <i class="fa fa-remove" id="minus"></i>
        </span>

        <button
            class="btn btn-default save-button pull-right"
            data-toggle="tooltip"
            title="Save Changes"
            type="button">
            Save
        </button>
    }
</td>

<script>
    // SaveTeacherChanges(string Id, string workloadId, string Allocated)
    // DeleteTeacher(Guid id, Guid workloadId)

    /*
    var teacherId = $(elem).data('teacher');
    var offeringId = $(elem).data('offering');
    var workloadId = $(elem).data('workload');
    var hours = $('#' + workloadId).val();
    console.log(hours);
    $.ajax({
        type: "POST",
        url: 'Url.Action("AlterTeacherAllocation", "Teacher")',
        contentType: "application/json",
        data: JSON.stringify({
            teacherId: teacherId,
            offeringId: offeringId,
            workloadId: workloadId,
            hours: hours
        }),
        dataType: "json",
        success: function() {
            console.log("success");
            location.reload();
        },
        error: function() {
            console.log("error");
            location.reload();
        }
    });
    */

    function DeleteTeacher(elem) {
        var id = $(elem).data('offeringid');
        var workloadId = $(elem).data('workloadid');
        console.log("OfferingId: " + id + "\nWorkloadId: " + workloadId);
        $.ajax({
            type: "POST",
            url: '@Url.Action("DeleteTeacher", "Course")',
            contentType: "application/json",
            data: JSON.stringify({
                id: id,
                workloadId: workloadId
            }),
            dataType: "json",
            complete: function() {
                location.reload();
            }
        });
    }

    function CancelChanges(elem) {
        var workload = $(elem).data("workload");
        var elemId = "#" + $(elem).data("workloadid");
        var inputField = $(elemId);
        inputField.val(workload);
    }

    function SaveChanges(elem) {
        location.reload();
    }
</script>
